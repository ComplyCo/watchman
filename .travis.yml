language: go
dist: xenial
sudo: true
services: [docker]

matrix:
  include:
  - os: linux
    go: 1.14.x

before_deploy:
  - make dist

deploy:
  provider: releases
  api_key:
    secure: lPJQJFPgzw0eAZwG6A5yG3hMVrkuAeXhZy0wcWpOHWH/Ten2uDPo0hm4W5aoeTLi0ABEL9YWeheZRtq5BY9sxNBZLoGf4duz9q4Nc+WvrJT7dIEaynbK1ou2ycHPU35VX3FY6wdcCBPxcDVNQiKHgreXpY6IbcBj8iDWYaaz945INoN+8LAkceyeonrm7AeqeS2jEmdbxlOAHxGFh2mgP2XylLAIKrWe/tvOEPvn7Hz/EIjTJE7K5+j+UhNFFUd+VtcN8I/qyPrs9IoleIKrU9lx1RcrXA0EPDt+bXFzc233Uwa5lYBsj3mtI1imriCEy9ByA8CEBwYOxa9KQPendkGlwqGrKn3bjDXKuBKM7nsiJWG4uHUABMQGBVDXGXcOJnDsmcaR69sCrNxFWed8R4YpYC/QLZkNVPnw4E08dQ9gaw83I6mUW01/qeFczgDd/HDjhNRB1o6/y4Jb5kPVTRYiQ8p+suAmhPfmIUOKlSjwBTB95LisrWtEud66tzfkV9XdKvuxh0FYdlIGDhexcUEME7ZkYo5gelDPmX4V5NagBmKd+9Y+xYAsqCE/Z3Vy0DWRyGZYZGxWcQ5+8M0XlYrPqBP6saDALM8XI+apNuLa3KKzozS5s4G2F9vSVyFHOS+uhOnAz6gftrL9t6g2E9KHiN43tf2JhNrsVNqZbEs=
  file_glob: true
  file:
    - bin/watchman-*
    - bin/watchman.exe
  on:
    repo: moov-io/watchman
    tags: true
    go: 1.14.x
  skip_cleanup: true

after_deploy:
  - echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_USERNAME" --password-stdin
  - make release-push

notifications:
  slack:
    secure: aX1Wt+WcuSLKIg02HzarFp57l+KaPKxOwFf7cuaKyaCdvnf8XuLd+/yWwYSXZTeqgZ9PE6MxQHh+j3JT9du0Uo4BXQbcF6WMF/VwrN1qOCGeJvNr+RAHGqodcfWDRKLzxgcY7AMwGVbXA2ECfJiWYaXVlSojSXwPUGlWUdq83hCwjs5qSR/AFlHEYmaTWnSu53nvBDzoc+25PnUnNRLrZAo2zmVijyozxXVZ5E+uVZrpX/zDZjlZbCDMTnMTcLfPm+Dz5li9QY20LQX8eXJN4RaC/mBEIOashN/7A6Pnh5JioSVQ2WuPhRoCG81yMxQkZulIbJ4XGynWDVFdoKeXSHMrI5PX+q396n9sxEeEhAwi0nv48Mb4MmXKXUliNZ1yr+kxGPPkU/I3BGYXdA23iaTh/0pc/AuTFO7GSwf4MoRCCMI4nm47rFcA+3fcwGwNVcAG0YzsgMfriXXzuBXm2sEU4Ix6rEo7RQHQ1uOI0wT1EiET3x4iANRsoN1cu//FfEz1se/MpWLMZuAP4glaXbz0jxcET/2rM+g54ydPDscS4mcOiTyhAzlG79lMWFPCC2u5nqOH7ZGz1/oEb2uxTbVpPsKYrIRctOs6sp35rVjVIscMFEOmi5m/TUu7wtdGavvbZ7t3AfnPns1M995r6IK9ibRY2kETnGmU/ao+z7E=
